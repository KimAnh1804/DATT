{"ast":null,"code":"\"use client\";import{useState,useEffect}from\"react\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Inventory=()=>{const[activeTab,setActiveTab]=useState(\"import\");const[products,setProducts]=useState([]);const[transactions,setTransactions]=useState([]);const[loading,setLoading]=useState(true);const[saving,setSaving]=useState(false);const[formData,setFormData]=useState({productId:\"\",quantity:1,note:\"\"});useEffect(()=>{fetchProducts();fetchTransactions();},[]);const fetchProducts=async()=>{try{const token=localStorage.getItem(\"token\");const response=await fetch(\"http://localhost:5000/api/products\",{headers:{Authorization:`Bearer ${token}`}});if(response.ok){const data=await response.json();setProducts(data);// Set default selected product if products are available and no product is selected\nif(data.length>0&&!formData.productId){setFormData(prev=>({...prev,productId:data[0]._id}));}}}catch(error){console.error(\"Error fetching products:\",error);}};const fetchTransactions=async()=>{try{const token=localStorage.getItem(\"token\");const response=await fetch(\"http://localhost:5000/api/inventory/transactions\",{headers:{Authorization:`Bearer ${token}`}});if(response.ok){const data=await response.json();setTransactions(data);}}catch(error){console.error(\"Error fetching transactions:\",error);}finally{setLoading(false);}};const handleSubmit=async e=>{e.preventDefault();setSaving(true);try{const token=localStorage.getItem(\"token\");const response=await fetch(\"http://localhost:5000/api/inventory/transaction\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${token}`},body:JSON.stringify({...formData,type:activeTab})});if(response.ok){await fetchTransactions();await fetchProducts();// Refresh products to update stock\nresetForm();alert(`${activeTab===\"import\"?\"Nhập\":\"Xuất\"} kho thành công!`);}else{const error=await response.json();alert(error.message||\"Có lỗi xảy ra!\");}}catch(error){console.error(\"Error creating transaction:\",error);alert(\"Có lỗi xảy ra!\");}finally{setSaving(false);}};const resetForm=()=>{setFormData({productId:products.length>0?products[0]._id:\"\",// Reset to first product or empty\nquantity:1,note:\"\"});};const getSelectedProduct=()=>{return products.find(p=>p._id===formData.productId);};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-8\",children:\"\\u0110ang t\\u1EA3i d\\u1EEF li\\u1EC7u...\"});}const selectedProduct=getSelectedProduct();// Lấy sản phẩm đã chọn một lần\nreturn/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900 mb-6\",children:\"Qu\\u1EA3n l\\xFD nh\\u1EADp/xu\\u1EA5t kho\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"nav\",{className:\"-mb-px flex space-x-8\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab(\"import\"),className:`py-2 px-1 border-b-2 font-medium text-sm ${activeTab===\"import\"?\"border-blue-500 text-blue-600\":\"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300\"}`,children:\"\\uD83D\\uDCE5 Nh\\u1EADp kho\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab(\"export\"),className:`py-2 px-1 border-b-2 font-medium text-sm ${activeTab===\"export\"?\"border-blue-500 text-blue-600\":\"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300\"}`,children:\"\\uD83D\\uDCE4 Xu\\u1EA5t kho\"})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white shadow rounded-lg p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-medium text-gray-900 mb-4\",children:activeTab===\"import\"?\"Tạo phiếu nhập kho\":\"Tạo phiếu xuất kho\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",children:\"S\\u1EA3n ph\\u1EA9m *\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.productId,onChange:e=>setFormData({...formData,productId:e.target.value}),className:\"form-input\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Ch\\u1ECDn s\\u1EA3n ph\\u1EA9m\"}),products.map(product=>// Thêm kiểm tra an toàn để đảm bảo product không phải là null/undefined\nproduct?/*#__PURE__*/_jsxs(\"option\",{value:product._id,children:[product.name,\" - T\\u1ED3n kho: \",product.stock,\" \",product.unit]},product._id):null)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",children:[\"S\\u1ED1 l\\u01B0\\u1EE3ng \",activeTab===\"import\"?\"nhập\":\"xuất\",\" *\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:formData.quantity,onChange:e=>setFormData({...formData,quantity:Number(e.target.value)}),className:\"form-input\",min:\"1\"// Sử dụng optional chaining để truy cập stock một cách an toàn\n,max:activeTab===\"export\"?selectedProduct===null||selectedProduct===void 0?void 0:selectedProduct.stock:undefined,required:true}),activeTab===\"export\"&&selectedProduct&&/*#__PURE__*/// Kiểm tra selectedProduct trước khi hiển thị\n_jsxs(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:[\"T\\u1ED3n kho hi\\u1EC7n t\\u1EA1i: \",selectedProduct.stock,\" \",selectedProduct.unit]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",children:\"Ghi ch\\xFA\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.note,onChange:e=>setFormData({...formData,note:e.target.value}),className:\"form-input\",rows:3,placeholder:\"Nh\\u1EADp ghi ch\\xFA (t\\xF9y ch\\u1ECDn)\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:`w-full ${activeTab===\"import\"?\"btn-success\":\"btn-primary\"} disabled:opacity-50`,disabled:saving||!formData.productId// Disable if no product is selected\n,children:saving?\"Đang xử lý...\":activeTab===\"import\"?\"Tạo phiếu nhập\":\"Tạo phiếu xuất\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white shadow rounded-lg p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-medium text-gray-900 mb-4\",children:\"L\\u1ECBch s\\u1EED giao d\\u1ECBch\"}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-96 overflow-y-auto\",children:transactions.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-4\",children:\"Ch\\u01B0a c\\xF3 giao d\\u1ECBch n\\xE0o\"}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:transactions.map(transaction=>/*#__PURE__*/_jsx(\"div\",{className:`p-3 rounded-lg border-l-4 ${transaction.type===\"import\"?\"border-green-500 bg-green-50\":\"border-red-500 bg-red-50\"}`,children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium text-gray-900\",children:transaction.type===\"import\"?\"📥 Nhập kho\":\"📤 Xuất kho\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:transaction.product?/*#__PURE__*/_jsxs(_Fragment,{children:[transaction.product.name,\" - \",transaction.quantity,\" \",transaction.product.unit]}):/*#__PURE__*/_jsxs(\"span\",{className:\"text-red-500\",children:[\"S\\u1EA3n ph\\u1EA9m \\u0111\\xE3 x\\xF3a - S\\u1ED1 l\\u01B0\\u1EE3ng: \",transaction.quantity]})}),transaction.note&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 mt-1\",children:[\"Ghi ch\\xFA: \",transaction.note]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-right\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:new Date(transaction.createdAt).toLocaleString(\"vi-VN\")})})]})},transaction._id))})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-8 bg-white shadow rounded-lg p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-medium text-gray-900 mb-4\",children:\"Th\\u1ED1ng k\\xEA t\\u1ED3n kho\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-4 bg-blue-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-blue-600\",children:products.length}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"T\\u1ED5ng s\\u1ED1 s\\u1EA3n ph\\u1EA9m\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-4 bg-green-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-green-600\",children:transactions.filter(t=>t.type===\"import\").length}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"L\\u1EA7n nh\\u1EADp kho\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-4 bg-red-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-bold text-red-600\",children:transactions.filter(t=>t.type===\"export\").length}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"L\\u1EA7n xu\\u1EA5t kho\"})]})]})]})]});};export default Inventory;","map":{"version":3,"names":["useState","useEffect","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Inventory","activeTab","setActiveTab","products","setProducts","transactions","setTransactions","loading","setLoading","saving","setSaving","formData","setFormData","productId","quantity","note","fetchProducts","fetchTransactions","token","localStorage","getItem","response","fetch","headers","Authorization","ok","data","json","length","prev","_id","error","console","handleSubmit","e","preventDefault","method","body","JSON","stringify","type","resetForm","alert","message","getSelectedProduct","find","p","className","children","selectedProduct","onClick","onSubmit","value","onChange","target","required","map","product","name","stock","unit","Number","min","max","undefined","rows","placeholder","disabled","transaction","Date","createdAt","toLocaleString","filter","t"],"sources":["D:/DU LIEU O D/Code/inventory-management3/frontend/src/components/Inventory.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\nimport { useState, useEffect } from \"react\"\n\ninterface Product {\n  _id: string\n  name: string\n  unit: string\n  stock: number\n}\n\ninterface Transaction {\n  _id: string\n  product: {\n    // This product object might be null if the product was deleted\n    _id: string\n    name: string\n    unit: string\n  } | null // Allow product to be null\n  type: \"import\" | \"export\"\n  quantity: number\n  note: string\n  createdAt: string\n}\n\nconst Inventory: React.FC = () => {\n  const [activeTab, setActiveTab] = useState<\"import\" | \"export\">(\"import\")\n  const [products, setProducts] = useState<Product[]>([])\n  const [transactions, setTransactions] = useState<Transaction[]>([])\n  const [loading, setLoading] = useState(true)\n  const [saving, setSaving] = useState(false)\n  const [formData, setFormData] = useState({\n    productId: \"\",\n    quantity: 1,\n    note: \"\",\n  })\n\n  useEffect(() => {\n    fetchProducts()\n    fetchTransactions()\n  }, [])\n\n  const fetchProducts = async () => {\n    try {\n      const token = localStorage.getItem(\"token\")\n      const response = await fetch(\"http://localhost:5000/api/products\", {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      })\n\n      if (response.ok) {\n        const data = await response.json()\n        setProducts(data)\n        // Set default selected product if products are available and no product is selected\n        if (data.length > 0 && !formData.productId) {\n          setFormData((prev) => ({ ...prev, productId: data[0]._id }))\n        }\n      }\n    } catch (error) {\n      console.error(\"Error fetching products:\", error)\n    }\n  }\n\n  const fetchTransactions = async () => {\n    try {\n      const token = localStorage.getItem(\"token\")\n      const response = await fetch(\"http://localhost:5000/api/inventory/transactions\", {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      })\n\n      if (response.ok) {\n        const data = await response.json()\n        setTransactions(data)\n      }\n    } catch (error) {\n      console.error(\"Error fetching transactions:\", error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setSaving(true)\n\n    try {\n      const token = localStorage.getItem(\"token\")\n      const response = await fetch(\"http://localhost:5000/api/inventory/transaction\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({\n          ...formData,\n          type: activeTab,\n        }),\n      })\n\n      if (response.ok) {\n        await fetchTransactions()\n        await fetchProducts() // Refresh products to update stock\n        resetForm()\n        alert(`${activeTab === \"import\" ? \"Nhập\" : \"Xuất\"} kho thành công!`)\n      } else {\n        const error = await response.json()\n        alert(error.message || \"Có lỗi xảy ra!\")\n      }\n    } catch (error) {\n      console.error(\"Error creating transaction:\", error)\n      alert(\"Có lỗi xảy ra!\")\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  const resetForm = () => {\n    setFormData({\n      productId: products.length > 0 ? products[0]._id : \"\", // Reset to first product or empty\n      quantity: 1,\n      note: \"\",\n    })\n  }\n\n  const getSelectedProduct = () => {\n    return products.find((p) => p._id === formData.productId)\n  }\n\n  if (loading) {\n    return <div className=\"text-center py-8\">Đang tải dữ liệu...</div>\n  }\n\n  const selectedProduct = getSelectedProduct() // Lấy sản phẩm đã chọn một lần\n\n  return (\n    <div>\n      <h1 className=\"text-2xl font-bold text-gray-900 mb-6\">Quản lý nhập/xuất kho</h1>\n\n      {/* Tabs */}\n      <div className=\"mb-6\">\n        <div className=\"border-b border-gray-200\">\n          <nav className=\"-mb-px flex space-x-8\">\n            <button\n              onClick={() => setActiveTab(\"import\")}\n              className={`py-2 px-1 border-b-2 font-medium text-sm ${\n                activeTab === \"import\"\n                  ? \"border-blue-500 text-blue-600\"\n                  : \"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300\"\n              }`}\n            >\n              📥 Nhập kho\n            </button>\n            <button\n              onClick={() => setActiveTab(\"export\")}\n              className={`py-2 px-1 border-b-2 font-medium text-sm ${\n                activeTab === \"export\"\n                  ? \"border-blue-500 text-blue-600\"\n                  : \"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300\"\n              }`}\n            >\n              📤 Xuất kho\n            </button>\n          </nav>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Form */}\n        <div className=\"bg-white shadow rounded-lg p-6\">\n          <h2 className=\"text-lg font-medium text-gray-900 mb-4\">\n            {activeTab === \"import\" ? \"Tạo phiếu nhập kho\" : \"Tạo phiếu xuất kho\"}\n          </h2>\n\n          <form onSubmit={handleSubmit}>\n            <div className=\"mb-4\">\n              <label className=\"block text-gray-700 text-sm font-bold mb-2\">Sản phẩm *</label>\n              <select\n                value={formData.productId}\n                onChange={(e) => setFormData({ ...formData, productId: e.target.value })}\n                className=\"form-input\"\n                required\n              >\n                <option value=\"\">Chọn sản phẩm</option>\n                {products.map((product) =>\n                  // Thêm kiểm tra an toàn để đảm bảo product không phải là null/undefined\n                  product ? (\n                    <option key={product._id} value={product._id}>\n                      {product.name} - Tồn kho: {product.stock} {product.unit}\n                    </option>\n                  ) : null,\n                )}\n              </select>\n            </div>\n\n            <div className=\"mb-4\">\n              <label className=\"block text-gray-700 text-sm font-bold mb-2\">\n                Số lượng {activeTab === \"import\" ? \"nhập\" : \"xuất\"} *\n              </label>\n              <input\n                type=\"number\"\n                value={formData.quantity}\n                onChange={(e) => setFormData({ ...formData, quantity: Number(e.target.value) })}\n                className=\"form-input\"\n                min=\"1\"\n                // Sử dụng optional chaining để truy cập stock một cách an toàn\n                max={activeTab === \"export\" ? selectedProduct?.stock : undefined}\n                required\n              />\n              {activeTab === \"export\" &&\n                selectedProduct && ( // Kiểm tra selectedProduct trước khi hiển thị\n                  <p className=\"text-sm text-gray-600 mt-1\">\n                    Tồn kho hiện tại: {selectedProduct.stock} {selectedProduct.unit}\n                  </p>\n                )}\n            </div>\n\n            <div className=\"mb-6\">\n              <label className=\"block text-gray-700 text-sm font-bold mb-2\">Ghi chú</label>\n              <textarea\n                value={formData.note}\n                onChange={(e) => setFormData({ ...formData, note: e.target.value })}\n                className=\"form-input\"\n                rows={3}\n                placeholder=\"Nhập ghi chú (tùy chọn)\"\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              className={`w-full ${activeTab === \"import\" ? \"btn-success\" : \"btn-primary\"} disabled:opacity-50`}\n              disabled={saving || !formData.productId} // Disable if no product is selected\n            >\n              {saving ? \"Đang xử lý...\" : activeTab === \"import\" ? \"Tạo phiếu nhập\" : \"Tạo phiếu xuất\"}\n            </button>\n          </form>\n        </div>\n\n        {/* Transaction History */}\n        <div className=\"bg-white shadow rounded-lg p-6\">\n          <h2 className=\"text-lg font-medium text-gray-900 mb-4\">Lịch sử giao dịch</h2>\n\n          <div className=\"max-h-96 overflow-y-auto\">\n            {transactions.length === 0 ? (\n              <p className=\"text-gray-500 text-center py-4\">Chưa có giao dịch nào</p>\n            ) : (\n              <div className=\"space-y-3\">\n                {transactions.map((transaction) => (\n                  <div\n                    key={transaction._id}\n                    className={`p-3 rounded-lg border-l-4 ${\n                      transaction.type === \"import\" ? \"border-green-500 bg-green-50\" : \"border-red-500 bg-red-50\"\n                    }`}\n                  >\n                    <div className=\"flex justify-between items-start\">\n                      <div className=\"flex-1\">\n                        <p className=\"font-medium text-gray-900\">\n                          {transaction.type === \"import\" ? \"📥 Nhập kho\" : \"📤 Xuất kho\"}\n                        </p>\n                        <p className=\"text-sm text-gray-600\">\n                          {transaction.product ? (\n                            <>\n                              {transaction.product.name} - {transaction.quantity} {transaction.product.unit}\n                            </>\n                          ) : (\n                            <span className=\"text-red-500\">Sản phẩm đã xóa - Số lượng: {transaction.quantity}</span>\n                          )}\n                        </p>\n                        {transaction.note && <p className=\"text-sm text-gray-500 mt-1\">Ghi chú: {transaction.note}</p>}\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-xs text-gray-500\">\n                          {new Date(transaction.createdAt).toLocaleString(\"vi-VN\")}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Summary Statistics */}\n      <div className=\"mt-8 bg-white shadow rounded-lg p-6\">\n        <h2 className=\"text-lg font-medium text-gray-900 mb-4\">Thống kê tồn kho</h2>\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <div className=\"text-center p-4 bg-blue-50 rounded-lg\">\n            <p className=\"text-2xl font-bold text-blue-600\">{products.length}</p>\n            <p className=\"text-sm text-gray-600\">Tổng số sản phẩm</p>\n          </div>\n          <div className=\"text-center p-4 bg-green-50 rounded-lg\">\n            <p className=\"text-2xl font-bold text-green-600\">\n              {transactions.filter((t) => t.type === \"import\").length}\n            </p>\n            <p className=\"text-sm text-gray-600\">Lần nhập kho</p>\n          </div>\n          <div className=\"text-center p-4 bg-red-50 rounded-lg\">\n            <p className=\"text-2xl font-bold text-red-600\">{transactions.filter((t) => t.type === \"export\").length}</p>\n            <p className=\"text-sm text-gray-600\">Lần xuất kho</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default Inventory\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}